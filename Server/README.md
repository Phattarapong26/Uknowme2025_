# API ระบบบริหารจัดการการเรียนรู้

## คู่มือการใช้งาน Swagger UI เพื่อทดสอบ API

Swagger UI เป็นเครื่องมือที่ช่วยให้คุณสามารถเรียกทดสอบ API ได้โดยตรงจากเว็บบราวเซอร์ โดยไม่ต้องใช้โปรแกรมอื่นๆ

### วิธีเข้าถึง Swagger UI

1. เปิดเซิร์ฟเวอร์โดยใช้คำสั่ง:
   ```
   npm run dev
   ```

2. เปิดเว็บบราวเซอร์และเข้าไปที่:
   ```
   http://localhost:3000/api-docs
   ```

### วิธีการทดสอบ API

#### 1. การทดสอบ API ที่ไม่ต้องการการยืนยันตัวตน

1. เลือก endpoint ที่ต้องการทดสอบ (เช่น `/api/login`)
2. คลิกที่ปุ่ม "Try it out"
3. กรอกข้อมูลในฟอร์มที่แสดง
4. คลิกที่ปุ่ม "Execute"
5. ผลลัพธ์จะแสดงในส่วน "Response"

#### 2. การทดสอบ API ที่ต้องการการยืนยันตัวตน (Bearer Token)

1. ก่อนอื่นให้เรียกใช้ API สำหรับเข้าสู่ระบบ `/api/login` เพื่อรับ token
2. หลังจากได้รับ token ให้คลิกที่ปุ่ม "Authorize" ด้านบนขวาของหน้าจอ
3. ในช่อง Value ให้ใส่คำว่า "Bearer" ตามด้วยเว้นวรรคและต่อด้วย token ที่ได้รับ เช่น `Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
4. คลิกที่ปุ่ม "Authorize" และปิดหน้าต่าง
5. ตอนนี้คุณสามารถเรียกใช้ API ที่ต้องการการยืนยันตัวตนได้แล้ว

### ตัวอย่างการทดสอบ

#### 1. การเข้าสู่ระบบ

1. เลือก endpoint `/api/login`
2. กรอกข้อมูลดังนี้:
   ```json
   {
     "email": "example@email.com",
     "password": "password123",
     "role": "user"
   }
   ```
3. คลิก Execute และจดบันทึก token ที่ได้รับ

#### 2. การดูรายการผู้ใช้ (ต้องมีสิทธิ์ Admin)

1. ขั้นแรกเข้าสู่ระบบด้วยบัญชีผู้ดูแลระบบ
2. คลิกที่ปุ่ม "Authorize" และใส่ token
3. เลือก endpoint `/api/Admin/Get/users`
4. คลิก Execute
5. ระบบจะแสดงรายการผู้ใช้ทั้งหมด

### ข้อควรระวัง

- Token มีอายุการใช้งาน หากพบข้อผิดพลาด 401 Unauthorized อาจต้องเข้าสู่ระบบและรับ token ใหม่
- การทดสอบบาง API ที่มีการอัพโหลดไฟล์ อาจไม่สามารถทำผ่าน Swagger UI ได้อย่างสมบูรณ์
- การใช้งาน Swagger UI ในสภาพแวดล้อมการผลิต (Production) อาจก่อให้เกิดความเสี่ยงด้านความปลอดภัย ควรเปิดใช้งานเฉพาะในสภาพแวดล้อมการพัฒนา (Development) เท่านั้น

### การแก้ไขปัญหาที่พบบ่อย

1. **ข้อผิดพลาด CORS**
   - ตรวจสอบการตั้งค่า CORS ในไฟล์ `app.ts`

2. **ข้อผิดพลาด 401 Unauthorized**
   - ตรวจสอบว่าใส่ token ถูกต้องหรือไม่
   - ตรวจสอบว่า token หมดอายุหรือไม่

3. **การทดสอบอัพโหลดไฟล์**
   - ใช้โปรแกรม Postman หรือ curl แทน Swagger UI สำหรับการทดสอบที่มีการอัพโหลดไฟล์ 